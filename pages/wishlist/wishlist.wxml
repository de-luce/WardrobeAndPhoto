<!--pages/wishlist/wishlist.wxml-->
<view class="wishlist-container">
  <!-- é¡¶éƒ¨æ·»åŠ æŒ‰é’® -->
  <view class="header">
    <view class="add-btn" bindtap="showAddModal">
      <text class="add-icon">+</text>
      <text>æ·»åŠ å¿ƒæ„¿</text>
    </view>
  </view>

  <!-- ç­›é€‰æ  -->
  <view class="filter-bar">
    <view 
      class="filter-item {{filterType === 'all' ? 'active' : ''}}"
      bindtap="switchFilter"
      data-type="all"
    >
      <text>å…¨éƒ¨</text>
      <text class="filter-count">{{filterCounts.all}}</text>
    </view>
    <view 
      class="filter-item {{filterType === 'active' ? 'active' : ''}}"
      bindtap="switchFilter"
      data-type="active"
    >
      <text>å¾…å®Œæˆ</text>
      <text class="filter-count">{{filterCounts.active}}</text>
    </view>
    <view 
      class="filter-item {{filterType === 'completed' ? 'active' : ''}}"
      bindtap="switchFilter"
      data-type="completed"
    >
      <text>å·²å®Œæˆ</text>
      <text class="filter-count">{{filterCounts.completed}}</text>
    </view>
  </view>

  <!-- å¿ƒæ„¿å•åˆ—è¡¨ -->
  <view class="wishlist-content">
    <view 
      class="wish-item {{item.completed ? 'completed' : ''}}" 
      wx:for="{{filteredList}}" 
      wx:key="id"
    >
      <view class="item-checkbox" bindtap="toggleComplete" data-id="{{item.id}}">
        <view class="checkbox-circle {{item.completed ? 'checked' : ''}}">
          <text class="checkbox-icon" wx:if="{{item.completed}}">âœ“</text>
        </view>
      </view>
      <view class="item-content" bindtap="showAddModal" data-item="{{item}}">
        <view class="item-main">
          <view class="item-title-wrapper">
            <text class="item-title">{{item.title}}</text>
            <view class="item-image-mini" wx:if="{{item.imageUrl}}">
              <image class="mini-image" src="{{item.imageUrl}}" mode="aspectFill" bindtap="previewImage" data-url="{{item.imageUrl}}"></image>
            </view>
          </view>
          <view class="item-details" wx:if="{{item.price || (item.tags && item.tags.length > 0) || item.note}}">
            <text class="detail-item" wx:if="{{item.price}}">Â¥{{item.price}}</text>
            <text class="detail-item tag-item" wx:for="{{item.tags}}" wx:key="*this" wx:for-item="tag">{{tag}}</text>
            <text class="detail-item note-item" wx:if="{{item.note}}">{{item.note}}</text>
          </view>
        </view>
      </view>
      <view class="item-delete" catchtap="deleteWish" data-id="{{item.id}}">
        <text class="delete-icon">ğŸ—‘ï¸</text>
      </view>
    </view>
    <view wx:if="{{filteredList.length === 0}}" class="empty-state">
      <text class="empty-icon">{{filterType === 'completed' ? 'ğŸ‰' : filterType === 'active' ? 'âœ¨' : 'â­'}}</text>
      <text class="empty-text">
        {{filterType === 'completed' ? 'è¿˜æ²¡æœ‰å®Œæˆçš„å¿ƒæ„¿ï¼ŒåŠ æ²¹ï¼' : filterType === 'active' ? 'å¤ªæ£’äº†ï¼Œæ‰€æœ‰å¿ƒæ„¿éƒ½å·²å®Œæˆï¼' : 'å¿ƒæ„¿å•è¿˜æ˜¯ç©ºçš„ï¼Œå¿«æ¥æ·»åŠ ç¬¬ä¸€ä¸ªå¿ƒæ„¿å§~'}}
      </text>
    </view>
  </view>

  <!-- æ·»åŠ /ç¼–è¾‘æ¨¡æ€æ¡† -->
  <view class="modal {{showAddModal ? 'show' : ''}}" catchtap="hideAddModal">
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">{{editId ? 'ç¼–è¾‘å¿ƒæ„¿' : 'æ·»åŠ å¿ƒæ„¿'}}</text>
        <text class="modal-close" bindtap="hideAddModal">Ã—</text>
      </view>
      <scroll-view class="modal-body" scroll-y>
        <view class="form-group">
          <text class="form-label">æ ‡é¢˜ *</text>
          <input 
            class="form-input" 
            placeholder="è¯·è¾“å…¥æ ‡é¢˜" 
            value="{{formData.title}}"
            data-field="title"
            bindinput="onInput"
          />
        </view>

        <view class="form-group">
          <text class="form-label">å›¾ç‰‡</text>
          <view class="image-upload" bindtap="chooseImage">
            <image wx:if="{{formData.imageUrl}}" class="uploaded-image" src="{{formData.imageUrl}}" mode="aspectFill"></image>
            <view wx:else class="upload-placeholder">
              <text class="upload-icon">ğŸ“·</text>
              <text class="upload-text">ç‚¹å‡»é€‰æ‹©å›¾ç‰‡</text>
            </view>
          </view>
        </view>

        <view class="form-group">
          <text class="form-label">ä»·æ ¼</text>
          <input 
            class="form-input" 
            type="digit"
            placeholder="è¯·è¾“å…¥ä»·æ ¼" 
            value="{{formData.price}}"
            data-field="price"
            bindinput="onInput"
          />
        </view>

        <view class="form-group">
          <text class="form-label">é“¾æ¥</text>
          <input 
            class="form-input" 
            placeholder="è¯·è¾“å…¥å•†å“é“¾æ¥" 
            value="{{formData.link}}"
            data-field="link"
            bindinput="onInput"
          />
        </view>

        <view class="form-group">
          <text class="form-label">æ ‡ç­¾ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰</text>
          <input 
            class="form-input" 
            placeholder="ä¾‹å¦‚ï¼šæ˜¥å­£,ä¸Šè¡£,ä¼‘é—²" 
            value="{{formData.tags}}"
            data-field="tags"
            bindinput="onInput"
          />
        </view>

        <view class="form-group">
          <text class="form-label">å¤‡æ³¨</text>
          <textarea 
            class="form-textarea" 
            placeholder="è¯·è¾“å…¥å¤‡æ³¨ä¿¡æ¯" 
            value="{{formData.note}}"
            data-field="note"
            bindinput="onInput"
            maxlength="200"
            auto-height
          />
        </view>

        <button class="save-btn" bindtap="saveWish">ä¿å­˜</button>
      </scroll-view>
    </view>
  </view>
</view>

